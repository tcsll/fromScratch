题目: 1000W个人去购买100件商品,请设计出改场景并保证高可用与幂等性

首先我们理解一下分布式锁的思想:
需要满足的特性:
（1）各个服务器都可以对其进行获取和操作（基于数据库的实现方式）；
（2）高性能的获取和释放锁；
（3）具备非阻塞锁特性，如果获取不到锁则立即返回失败；--也有的说具备阻塞锁的条件(待研究)
（4）具备锁等待的特性，即没有获取到锁将继续等待获取锁；
（5）具有锁失效机制，防止死锁；
（6）具备可重入特性；

基于Redis的分布式锁的实现思想:
A、加锁
1、计算开始时间，防止一直获取不到锁而死循环；
2、根据系统名称：业务名称：主键ID来创建一个分布式锁的key；
3、循环获取分布式锁（尝试时间=当前时间-开始时间<5000毫秒）；
4、使用setnx方法获取分布式锁（key,value - 当前系统时间+"$TRUE"，失效时间 - 10毫秒）；
5、如果设置成功则获取分布式锁成功，返回true；
6、如果获取失败则睡5毫秒，继续尝试，直到过了时间；
7、如果时间之内没有获取到分布式所，则返回失败；

B、解锁
1、根据系统号，业务名称，主键拼接分布式锁的key；
2、根据key获取到真实的key（使用keys方法）；
3、判断真实的key是否为存在，是否唯一，否则为空；
4、如果key唯一则进行删除；

场景实现:
